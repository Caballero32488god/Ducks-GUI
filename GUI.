local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local SaveManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/SaveManager.lua"))()
local InterfaceManager = loadstring(game:HttpGet("https://raw.githubusercontent.com/dawid-scripts/Fluent/master/Addons/InterfaceManager.lua"))()

local Window = Fluent:CreateWindow({
    Title = "Fluent " .. Fluent.Version,
    SubTitle = "by dawid",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "dice-1" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" }),
    Killer = Window:AddTab({ Title = "Killer", Icon = "skull" })
}

local Options = Fluent.Options

do
    -- Function to get all player names
    local function getAllPlayerNames()
        local playerNames = {}
        for _, player in ipairs(Players:GetPlayers()) do
            table.insert(playerNames, player.Name)
        end
        return playerNames
    end

    -- Killer Tab setup
    local Players = game:GetService("Players")
    local LocalPlayer = Players.LocalPlayer

    -- Kill Single Person Dropdown
    local DropdownKillSingle = Tabs.Killer:AddDropdown("KillSingleDropdown", {
        Title = "Kill Single Person",
        Values = getAllPlayerNames(),
        Multi = false
    })

    -- Kill Multiple People Dropdown
    local DropdownKillMultiple = Tabs.Killer:AddDropdown("KillMultipleDropdown", {
        Title = "Kill Multiple People",
        Values = getAllPlayerNames(),
        Multi = true
    })

    -- NoKill Single Person Dropdown
    local DropdownNoKillSingle = Tabs.Killer:AddDropdown("NoKillSingleDropdown", {
        Title = "NoKill Single Person",
        Values = getAllPlayerNames(),
        Multi = false
    })

    -- NoKill Multiple People Dropdown
    local DropdownNoKillMultiple = Tabs.Killer:AddDropdown("NoKillMultipleDropdown", {
        Title = "NoKill Multiple People",
        Values = getAllPlayerNames(),
        Multi = true
    })

    -- Start Killing Button
    Tabs.Killer:AddButton({
        Title = "Start Killing",
        Callback = function()
            -- Set tools for the user
            local function setUserTools()
                local tools = {
                    "Punch", "Ground Slam", "Stomp", "Handstands", "Pushups", "Weight", "Situps"
                }
                for _, tool in ipairs(tools) do
                    local item = LocalPlayer.Backpack:FindFirstChild(tool)
                    if item then
                        item.attackTime.Value = 0.1
                        item.repTime.Value = 0.1
                    end
                end
            end

            setUserTools()

            -- Equip Punch tool and start punching
            local function equipAndPunch()
                local punchTool = LocalPlayer.Backpack:FindFirstChild("Punch")

                if punchTool then
                    LocalPlayer.Character.Humanoid:EquipTool(punchTool)
                    wait(0.1)

                    local function performPunch()
                        LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
                        LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
                    end

                    while true do
                        performPunch()
                        wait(0.5)
                    end
                else
                    print("Punch tool not found in Backpack.")
                end
            end

            equipAndPunch()
        end
    })
end

-- Settings tab (keep original settings intact)
InterfaceManager:BuildInterfaceSection(Tabs.Settings)
SaveManager:BuildConfigSection(Tabs.Settings)

Fluent:Notify({
    Title = "Fluent",
    Content = "The script has been loaded.",
    Duration = 8
})

-- Addons
SaveManager:SetLibrary(Fluent)
InterfaceManager:SetLibrary(Fluent)
SaveManager:IgnoreThemeSettings()
SaveManager:SetIgnoreIndexes({})
InterfaceManager:SetFolder("FluentScriptHub")
SaveManager:SetFolder("FluentScriptHub/specific-game")

Window:SelectTab(1)

-- Load autoload config
SaveManager:LoadAutoloadConfig()

-- Refresh dropdowns for all players when a player joins or leaves
Players.PlayerAdded:Connect(function()
    local allPlayerNames = getAllPlayerNames()
    DropdownKillSingle:SetValue(allPlayerNames)
    DropdownKillMultiple:SetValue(allPlayerNames)
    DropdownNoKillSingle:SetValue(allPlayerNames)
    DropdownNoKillMultiple:SetValue(allPlayerNames)
end)

Players.PlayerRemoving:Connect(function()
    local allPlayerNames = getAllPlayerNames()
    DropdownKillSingle:SetValue(allPlayerNames)
    DropdownKillMultiple:SetValue(allPlayerNames)
    DropdownNoKillSingle:SetValue(allPlayerNames)
    DropdownNoKillMultiple:SetValue(allPlayerNames)
end)
