local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local TeleportService = game:GetService("TeleportService")
local HttpService = game:GetService("HttpService")
local LocalPlayer = Players.LocalPlayer
local Camera = workspace.CurrentCamera
local RunService = game:GetService("RunService")
local ScreenGui = Instance.new("ScreenGui")
local Notification = Instance.new("TextLabel")

-- Create the Fluent UI
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local Window = Fluent:CreateWindow({
    Title = "Fluent " .. Fluent.Version,
    SubTitle = "by dawid",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
})

-- Add Tabs
local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "home" }),
    Options = Window:AddTab({ Title = "Options", Icon = "settings" }),
    Killer = Window:AddTab({ Title = "Killer", Icon = "skull" })
}

-- Notify that the GUI has loaded
Fluent:Notify({
    Title = "Welcome!",
    Content = "This GUI includes various settings.",
    Duration = 5
})

-- Main Tab Content
local MainSection = Tabs.Main:AddSection("Main Controls")

-- Speed Input
MainSection:AddInput("Speed", {
    Title = "Change Speed",
    Placeholder = "Enter Speed Value",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            LocalPlayer.Character.Humanoid.WalkSpeed = num
        end
    end
})

-- Jump Power Input
MainSection:AddInput("JumpPower", {
    Title = "Change Jump Power",
    Placeholder = "Enter Jump Power Value",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            LocalPlayer.Character.Humanoid.JumpPower = num
        end
    end
})

-- Infinite Jump Toggle
local infiniteJumpToggle = MainSection:AddToggle("Infinite Jump", {
    Title = "Enable Infinite Jump",
    Default = false,
})

UserInputService.JumpRequest:Connect(function()
    if infiniteJumpToggle.Value then
        local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
        if humanoid then
            humanoid:ChangeState(Enum.HumanoidStateType.Jumping)
        end
    end
end)

-- Noclip Toggle
local noclipToggle = MainSection:AddToggle("Noclip", {
    Title = "Enable Noclip",
    Default = false,
})

local function setNoclip(value)
    local character = LocalPlayer.Character
    if character then
        for _, part in ipairs(character:GetChildren()) do
            if part:IsA("BasePart") then
                part.CanCollide = not value
            end
        end
    end
end

noclipToggle:OnChanged(function(value)
    while noclipToggle.Value do
        setNoclip(true)
        wait(0.1)
    end
    setNoclip(false)
end)

-- Gravity Changer Input
MainSection:AddInput("Gravity", {
    Title = "Change Gravity",
    Placeholder = "Enter Gravity Value",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            workspace.Gravity = num
        end
    end
})

-- FOV Input
MainSection:AddInput("FOV", {
    Title = "Change FOV",
    Placeholder = "Enter FOV Value",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            Camera.FieldOfView = num
        end
    end
})

-- Options Tab Content
local OptionsSection = Tabs.Options:AddSection("Advanced Controls")

-- Music Toggle
local musicToggle = OptionsSection:AddToggle("Background Music", {
    Title = "Enable Background Music",
    Default = false,
})

-- Create a Sound object for the background music
local musicSound
local function setupMusic()
    musicSound = Instance.new("Sound")
    musicSound.SoundId = "rbxassetid://139235100" -- Your audio asset ID
    musicSound.Looped = true -- Set to loop
    musicSound.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui") -- Parent to PlayerGui
end

setupMusic() -- Set up the music when the script runs

-- Toggle music on and off
musicToggle:OnChanged(function(value)
    if value then
        musicSound:Play() -- Play the music
    else
        musicSound:Stop() -- Stop the music
    end
end)

-- Create a Sound object for the looping sound
local loopedSound
local function setupLoopedSound()
    loopedSound = Instance.new("Sound")
    loopedSound.SoundId = "rbxassetid://6847929757" -- Your audio asset ID
    loopedSound.Looped = true -- Set to loop
    loopedSound.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui") -- Parent to PlayerGui
end

setupLoopedSound() -- Set up the looped sound when the script runs

-- Button to control the looped sound
OptionsSection:AddButton("Toggle Loop Sound", {
    Title = "Play/Pause Looping Sound",
    Callback = function()
        if loopedSound.IsPlaying then
            loopedSound:Stop() -- Stop if currently playing
            Fluent:Notify({
                Title = "Loop Sound",
                Content = "Looping sound paused.",
                Duration = 3
            })
        else
            loopedSound:Play() -- Play if currently stopped
            Fluent:Notify({
                Title = "Loop Sound",
                Content = "Looping sound playing.",
                Duration = 3
            })
        end
    end
})

-- Rejoin Button
local function rejoinServer()
    TeleportService:TeleportToPlaceInstance(game.PlaceId, game.JobId)
end

OptionsSection:AddButton("Rejoin Server", {
    Title = "Rejoin Current Server",
    Callback = rejoinServer,
})

-- Reset Settings Button
local function resetSettings()
    musicToggle.Value = false
    musicSound:Stop() -- Stop background music
    loopedSound:Stop() -- Stop looped sound
    print("Settings reset to defaults.")
    Fluent:Notify({
        Title = "Settings Reset",
        Content = "All settings have been reset to defaults.",
        Duration = 3
    })
end

OptionsSection:AddButton("Reset Settings", {
    Title = "Reset All Settings",
    Callback = resetSettings,
})

-- Killer Tab Content
local KillerSection = Tabs.Killer:AddSection("Killer Controls")

-- Global variable for teleportation state
_G.teleportPlayersActive = true

-- Function to create and display notification
local function showNotification(message)
    Notification.Text = message
    Notification.Size = UDim2.new(0.3, 0, 0.1, 0)
    Notification.Position = UDim2.new(0.5, -75, 0.1, 0)
    Notification.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Notification.TextColor3 = Color3.fromRGB(255, 255, 255)
    Notification.TextScaled = true
    Notification.Parent = ScreenGui

    ScreenGui.Parent = game.CoreGui

    -- Fade out effect
    for i = 1, 10 do
        wait(0.1)
        Notification.TextTransparency = i / 10
    end

    Notification:Destroy()
end

-- Function to continuously teleport player characters
local function teleportPlayers()
    while _G.teleportPlayersActive do
        wait(0.1) -- Adjust the wait time as needed for performance

        for _, otherPlayer in pairs(Players:GetPlayers()) do
            if otherPlayer ~= LocalPlayer then
                local targetCharacter = otherPlayer.Character
                if targetCharacter and targetCharacter:FindFirstChild("HumanoidRootPart") then
                    targetCharacter:SetPrimaryPartCFrame(LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 5, 0))
                end
            end
        end
    end
end

-- Kill All Button
KillerSection:AddButton("Kill All", {
    Title = "Eliminate All Players",
    Callback = function()
        for _, player in ipairs(Players:GetPlayers()) do
            if player ~= LocalPlayer then
                if player.Character then
                    player.Character:BreakJoints()  -- This will eliminate the player
                end
            end
        end
        -- Start teleporting players after killing them
        teleportPlayers()
        showNotification("Started teleporting players.")
    end
})

-- Final touches
Window:SelectTab(1) -- Ensure the first tab is selected on open
