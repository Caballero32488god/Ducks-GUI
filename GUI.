local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local ScreenGui = Instance.new("ScreenGui")
local ToggleButton = Instance.new("TextButton")

-- Global variables
_G.startKilling = false
local punching = false -- Toggle state
local toolName = "Punch" -- Ensure this matches your tool's name

-- Create the toggle button
ToggleButton.Size = UDim2.new(0, 150, 0, 50)
ToggleButton.Position = UDim2.new(0.5, -75, 0.5, -25)
ToggleButton.Text = "Start Killing"
ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.Parent = ScreenGui

ScreenGui.Parent = game.CoreGui

-- Function to create and display notification
local function showNotification(message)
    local Notification = Instance.new("TextLabel")
    Notification.Text = message
    Notification.Size = UDim2.new(0.3, 0, 0.1, 0)
    Notification.Position = UDim2.new(0.5, -75, 0.1, 0)
    Notification.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Notification.TextColor3 = Color3.fromRGB(255, 255, 255)
    Notification.TextScaled = true
    Notification.Parent = ScreenGui

    -- Fade out effect
    for i = 1, 10 do
        wait(0.1)
        Notification.TextTransparency = i / 10
    end

    Notification:Destroy()
end

-- Function to auto-use the tool
local function autoUseTool()
    local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    local tool = LocalPlayer.Backpack:FindFirstChild(toolName)

    if tool then
        -- Set the NumberValue to 0 for instant hits
        local numberValue = tool:FindFirstChildOfClass("NumberValue")
        if numberValue then
            numberValue.Value = 0 -- Set speed value to 0 for instant hits
        end

        wait(2) -- Wait for 2 seconds before equipping the tool
        humanoid:EquipTool(tool)

        while punching and tool.Parent == character do
            tool:Activate() -- Activate the tool
            wait(0) -- Wait time set to 0 for instant hits
        end
    end
end

-- Function to teleport and attack other players
local function startKilling()
    local character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()
    local humanoidRootPart = character:WaitForChild("HumanoidRootPart")

    _G.startKilling = true

    while _G.startKilling do
        for _, otherPlayer in pairs(Players:GetPlayers()) do
            if otherPlayer ~= LocalPlayer then
                local otherCharacter = otherPlayer.Character
                if otherCharacter and otherCharacter:FindFirstChild("HumanoidRootPart") then
                    local targetHRP = otherCharacter.HumanoidRootPart
                    
                    -- Teleport the other player's HumanoidRootPart to your position, -5 units in Z
                    targetHRP.CFrame = humanoidRootPart.CFrame * CFrame.new(0, 0, -5) -- Adjust Z to -5

                    punching = true -- Start auto-punching
                    autoUseTool() -- Call auto-use tool function
                end
            end
        end

        wait(0) -- Wait time set to 0 for continuous execution
    end
end

-- Toggle action on button click
ToggleButton.MouseButton1Click:Connect(function()
    if not _G.startKilling then
        showNotification("Started Killing!")
        startKilling()
        ToggleButton.Text = "Stop Killing"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    else
        _G.startKilling = false
        punching = false -- Stop auto-punching
        showNotification("Stopped Killing.")
        ToggleButton.Text = "Start Killing"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    end
end)

-- Initially show the button
ToggleButton.Visible = true
