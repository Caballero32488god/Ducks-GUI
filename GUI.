local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local LocalPlayer = Players.LocalPlayer
local Character = LocalPlayer.Character or LocalPlayer.CharacterAdded:Wait()

-- Create the Fluent UI
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local Window = Fluent:CreateWindow({
    Title = "Fluent " .. Fluent.Version,
    SubTitle = "by dawid",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = true,
    Theme = "Dark",
})

local Tabs = {
    Main = Window:AddTab({ Title = "Main", Icon = "home" }),
    Settings = Window:AddTab({ Title = "Settings", Icon = "settings" }),
    Fly = Window:AddTab({ Title = "Fly", Icon = "airplane" }),
}

-- Notify that the GUI has loaded
Fluent:Notify({
    Title = "Welcome!",
    Content = "This GUI includes flying and various settings.",
    Duration = 5
})

-- Speed Slider
local speedSlider = Tabs.Settings:AddSlider("Speed", {
    Title = "Change Speed",
    Default = 16,
    Min = 16,
    Max = 500,
    Rounding = 1,
    Callback = function(value)
        LocalPlayer.Character.Humanoid.WalkSpeed = value
    end
})

-- Jump Power Slider
local jumpSlider = Tabs.Settings:AddSlider("JumpPower", {
    Title = "Change Jump Power",
    Default = 50,
    Min = 50,
    Max = 500,
    Rounding = 1,
    Callback = function(value)
        LocalPlayer.Character.Humanoid.JumpPower = value
    end
})

-- Gravity Changer
local gravityInput = Tabs.Settings:AddInput("Gravity", {
    Title = "Change Gravity",
    Placeholder = "Enter Gravity Value",
    Callback = function(value)
        local num = tonumber(value)
        if num then
            workspace.Gravity = num
        end
    end
})

-- Time Manipulation Dropdown
local timeDropdown = Tabs.Settings:AddDropdown("Time Manipulation", {
    Title = "Select Time",
    Values = {"Morning", "Afternoon", "Night"},
    Multi = false,
    Default = 1,
})

timeDropdown:OnChanged(function(value)
    if value == "Morning" then
        game.Lighting.ClockTime = 6
    elseif value == "Afternoon" then
        game.Lighting.ClockTime = 12
    elseif value == "Night" then
        game.Lighting.ClockTime = 18
    end
end)

-- Flying Functionality
local flying = false
local flySpeed = 50
local bodyGyro, bodyVelocity

local function startFlying()
    flying = true
    local humanoidRootPart = Character:WaitForChild("HumanoidRootPart")

    -- Create BodyGyro and BodyVelocity
    bodyGyro = Instance.new("BodyGyro")
    bodyGyro.Parent = humanoidRootPart
    bodyGyro.MaxTorque = Vector3.new(4000, 4000, 4000)
    bodyGyro.P = 3000

    bodyVelocity = Instance.new("BodyVelocity")
    bodyVelocity.Parent = humanoidRootPart
    bodyVelocity.MaxForce = Vector3.new(4000, 4000, 4000)

    while flying do
        wait()
        bodyGyro.CFrame = CFrame.new(workspace.CurrentCamera.CFrame.Position, workspace.CurrentCamera.CFrame.Position + workspace.CurrentCamera.CFrame.LookVector)
        bodyVelocity.Velocity = (workspace.CurrentCamera.CFrame.LookVector * flySpeed) + Vector3.new(0, 50, 0)
    end
end

local function stopFlying()
    flying = false
    if bodyGyro then bodyGyro:Destroy() end
    if bodyVelocity then bodyVelocity:Destroy() end
end

-- Toggle fly with key press
UserInputService.InputBegan:Connect(function(input, gameProcessedEvent)
    if not gameProcessedEvent and input.KeyCode == Enum.KeyCode.F then
        if flying then
            stopFlying()
        else
            startFlying()
        end
    end
end)

-- Mobile Button for flying
local screenGui = Instance.new("ScreenGui", LocalPlayer.PlayerGui)
local flyButton = Instance.new("TextButton")
flyButton.Size = UDim2.new(0, 100, 0, 50)
flyButton.Position = UDim2.new(0.5, -50, 0.8, 0)
flyButton.Text = "Fly"
flyButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
flyButton.Parent = screenGui

flyButton.MouseButton1Click:Connect(function()
    if flying then
        stopFlying()
        flyButton.Text = "Fly"
        flyButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    else
        startFlying()
        flyButton.Text = "Stop"
        flyButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    end
end)

Window:SelectTab(1)
