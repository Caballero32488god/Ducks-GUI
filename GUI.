local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local ScreenGui = Instance.new("ScreenGui")
local ToggleButton = Instance.new("TextButton")

-- Global variable for teleportation state
_G.teleportPlayersActive = false

-- Create the toggle button
ToggleButton.Size = UDim2.new(0, 100, 0, 50)
ToggleButton.Position = UDim2.new(0.5, -50, 0.5, -25)
ToggleButton.Text = "Start Action"
ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ToggleButton.Parent = ScreenGui

ScreenGui.Parent = game.CoreGui

-- Function to create and display notification
local function showNotification(message)
    local Notification = Instance.new("TextLabel")
    Notification.Text = message
    Notification.Size = UDim2.new(0.3, 0, 0.1, 0)
    Notification.Position = UDim2.new(0.5, -75, 0.1, 0)
    Notification.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
    Notification.TextColor3 = Color3.fromRGB(255, 255, 255)
    Notification.TextScaled = true
    Notification.Parent = ScreenGui

    -- Fade out effect
    for i = 1, 10 do
        wait(0.1)
        Notification.TextTransparency = i / 10
    end

    Notification:Destroy()
end

-- Function to teleport and hit all players
local function teleportAndHitPlayers()
    while _G.teleportPlayersActive do
        for _, otherPlayer in pairs(Players:GetPlayers()) do
            if otherPlayer ~= LocalPlayer and otherPlayer.Character then
                local targetCharacter = otherPlayer.Character
                if targetCharacter:FindFirstChild("HumanoidRootPart") then
                    targetCharacter:SetPrimaryPartCFrame(LocalPlayer.Character.HumanoidRootPart.CFrame * CFrame.new(0, 5, 0))

                    -- Perform punching actions
                    local humanoid = targetCharacter:FindFirstChild("Humanoid")
                    if humanoid then
                        humanoid:ChangeState(Enum.HumanoidStateType.Jumping) -- Ensure the humanoid is in a state to be punched

                        if LocalPlayer:FindFirstChild("muscleEvent") then
                            LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
                            LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
                        end

                        if LocalPlayer.Backpack:FindFirstChild("Punch") then
                            humanoid:EquipTool(LocalPlayer.Backpack.Punch)
                        end

                        humanoid:TakeDamage(10) -- Adjust damage as needed
                    end
                end
            end
        end
        wait(0.1) -- Adjust the frequency of actions
    end
end

-- Start action
local function startAction()
    _G.teleportPlayersActive = true
    teleportAndHitPlayers()
end

-- Toggle action on button click
ToggleButton.MouseButton1Click:Connect(function()
    if not _G.teleportPlayersActive then
        showNotification("Action started.")
        startAction()
        ToggleButton.Text = "Stop Action"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
    else
        _G.teleportPlayersActive = false
        showNotification("Action stopped.")
        ToggleButton.Text = "Start Action"
        ToggleButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
    end
end)

-- Show the button for a short time and then remove it
wait(1) -- Show for 1 second
ToggleButton.Visible = true
wait(2) -- Keep it visible for 2 seconds
ToggleButton.Visible = false
