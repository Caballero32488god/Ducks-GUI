local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local friendsList = {}
_G.isActive = false
_G.noKillList = {}

local function getPlayerByName(name)
    for _, player in pairs(Players:GetPlayers()) do
        if player.Name:lower() == name:lower() or player.DisplayName:lower() == name:lower() then
            return player
        end
    end
    return nil
end

local function autoPunch(targetPlayerName)
    local targetPlayer = getPlayerByName(targetPlayerName)
    if targetPlayer and targetPlayer.Character and targetPlayer.Character:FindFirstChild("HumanoidRootPart") then
        LocalPlayer.Character.HumanoidRootPart.CFrame = targetPlayer.Character.HumanoidRootPart.CFrame
        LocalPlayer.muscleEvent:FireServer("punch", "leftHand")
        LocalPlayer.muscleEvent:FireServer("punch", "rightHand")
        LocalPlayer.Character.Humanoid:EquipTool(LocalPlayer.Backpack:FindFirstChild("Punch"))
    end
end

local function manageFriends()
    while _G.isActive do
        wait(5)
        friendsList = {}
        for _, friend in pairs(LocalPlayer:GetFriends()) do
            table.insert(friendsList, friend.Name)
        end
    end
end

LocalPlayer.Chatted:Connect(function(message)
    local args = message:split(" ")
    if args[1]:lower() == "on" then
        _G.isActive = true
        manageFriends()
    elseif args[1]:lower() == "off" then
        _G.isActive = false
    elseif args[1]:lower() == ";kill" and args[2] then
        autoPunch(args[2])
    elseif args[1]:lower() == ";nokill" and args[2] then
        local targetPlayer = getPlayerByName(args[2])
        if targetPlayer then
            _G.noKillList[targetPlayer.Name] = true
        end
    end
end)

print("Commands:")
print("'on' - Start auto punch.")
print("'off' - Stop auto punch.")
print(";kill PlayerName - Auto punch a player (by display name or username).")
print(";nokill PlayerName - Add a player to the no-kill list (by display name or username).")
